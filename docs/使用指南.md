# 📚 圖片智能命名系統 - 使用指南

**版本**：v1.1.2  
**最後更新**：2026-01-24

---

## 🎯 快速選擇：選擇適合您的使用方式

| 使用者類型 | 推薦方式 | 命令 |
|----------|--------|------|
| **非技術人員** | 📱 **GUI 圖形介面** | `bash scripts/gui.sh` |
| **一般使用者** | 🖥️ 互動式命令行 | `bash scripts/interactive_rename.sh` |
| **進階使用者** | 💻 Python 直接調用 | 見下文 |

---

## ⚡ 30 秒快速開始

### 最簡單的方式：使用 GUI（推薦 👍）

```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/gui.sh
```

**然後：**
1. ✅ 點擊「🗂️ 瀏覽資料夾...」選擇要命名的資料夾
2. ✅ 根據需要勾選選項（強制重新命名、刪除原檔案）
3. ✅ 點擊「🚀 開始命名」
4. ✅ 等待完成（進度會在下方顯示）

✨ **完全圖形化！不需要任何命令行知識。**

---

## 📱 三種使用方式詳解

### 方式 1️⃣：GUI 圖形介面（最推薦👍）

**特點：**
- ✅ 完全圖形化，無需命令行
- ✅ 資料夾選擇對話框（像資源管理器一樣）
- ✅ 複選框選擇功能選項
- ✅ 實時進度顯示
- ✅ 結果一目瞭然
- ✅ 最適合非技術人員

**使用步驟：**

```bash
bash scripts/gui.sh
```

**界面說明：**
- 📁 「瀏覽資料夾」：開啟資料夾選擇對話框
- 🔄 「強制重新命名」：勾選此項將重新分析所有檔案（包括已命名的）
- 🗑️ 「刪除原檔案」：勾選此項在命名完成後刪除原檔案（⚠️ 無法復原）
- 🚀 「開始命名」：開始執行命名（下方會顯示進度）

---

### 方式 2️⃣：互動式 Bash 腳本

**特點：**
- ✅ 友善的提示指引
- ✅ 自動處理路徑展開（~/ 等）
- ✅ 錯誤檢查和提示

**使用步驟：**

```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/interactive_rename.sh
```

---

### 方式 3️⃣：命令行直接調用（進階）

**如果您知道確切的資料夾路徑：**

```bash
# 基本用法
python3 src/full_batch_rename_execute.py --target-dir ~/Downloads

# 強制重新命名
python3 src/full_batch_rename_execute.py --target-dir ~/Downloads --force-rename

# 使用絕對路徑
python3 src/full_batch_rename_execute.py --target-dir /Users/hsiaojohnny/Documents/Photos
```

---

## 🎯 常見情況指南

### 情況 1：我要對 Downloads 資料夾中的圖片命名

**方式 1（GUI，推薦）：**
```bash
bash scripts/gui.sh
# 點擊「瀏覽資料夾」→ 選擇 Downloads → 點擊「開始命名」
```

**方式 2（命令行）：**
```bash
python3 src/full_batch_rename_execute.py --target-dir ~/Downloads
```

### 情況 2：我已經命名過一些檔案，現在有新檔案要命名

**程式會自動跳過已命名的檔案**（默認增量模式）

只需正常運行，程式會：
- ✅ 自動檢測已命名的檔案（檔名包含中文字符）
- ✅ 只處理未命名的檔案
- ✅ 節省時間和 API 調用

### 情況 3：我想重新命名已經命名過的檔案

**使用強制重新命名模式：**

方式 1（GUI）：
```bash
bash scripts/gui.sh
# 勾選「強制重新命名」→ 選擇資料夾 → 點擊「開始命名」
```

方式 2（命令行）：
```bash
python3 src/full_batch_rename_execute.py --target-dir ~/Downloads --force-rename
```

### 情況 4：我要掃描有多個子資料夾的目錄

**無需特別操作！** 程式會自動掃描所有子資料夾：

```bash
bash scripts/gui.sh
# 選擇最上層的資料夾
# 程式會自動掃描所有子資料夾（如 Line貼圖機器人、自動化腳本等）
```

支援的結構：
```
資料夾/
  ├── 圖片1.png              ✅ 會掃描
  ├── 子資料夾1/
  │   └── 圖片2.jpg          ✅ 會掃描
  └── 子資料夾2/
      └── 更深層資料夾/
          └── 圖片3.gif      ✅ 會掃描
```

---

## ❌ 遇到問題怎麼辦？

### 問題 1：打開 GUI 時出現錯誤

**解決方法：**
```bash
# 檢查 Python 版本
python3 --version  # 應該是 3.11+

# 檢查 conda 環境
conda activate image-rename

# 重新運行
bash scripts/gui.sh
```

### 問題 2：找不到要命名的資料夾

**確認：**
- ✅ 資料夾路徑正確（可在 Finder 中複製路徑）
- ✅ 資料夾不是空的
- ✅ 有讀取權限

### 問題 3：命名速度很慢

**原因和解決：**
- 🔴 **LM Studio 未啟動**：請先打開 LM Studio，確保伺服器運行
- 🔴 **圖片數量太多**：程式會分批處理，進度會顯示在 GUI 中
- 🔴 **電腦性能不足**：GPU 加速會大大提速（LM Studio 會自動使用）

### 問題 4：「操作已取消」或「找不到圖片」

**檢查清單：**
- ✅ 資料夾中確實有圖片（.png, .jpg, .jpeg, .webp, .gif, .bmp）
- ✅ 圖片不是損壞或特殊格式
- ✅ 資料夾有讀取權限

---

## 📊 理解結果

### 執行完成後會看到：

```
📊 掃描結果：找到 69 個圖片檔案
   已命名：5 個
   未命名：64 個

⚙️  開始處理 64 個未命名的檔案...

✅ 命名完成！
   成功：64 個
   失敗：0 個
   跳過：0 個
```

**什麼是「已命名」？**
- 檔名包含中文字符的檔案被認為已命名
- 程式會自動跳過（除非使用 `--force-rename`）

---

## 🔄 重複運行和進階使用

### 可以重複運行嗎？

✅ **可以！** 程式會自動：
1. 檢測已命名的檔案（默認跳過）
2. 只處理新的、未命名的檔案
3. 避免重複命名

### 進階：設置快捷方式

**在 macOS 中創建快捷方式：**

1. 打開「自動操作」
2. 選擇「新建快速操作」
3. 搜尋「執行 Shell 腳本」
4. 輸入：
   ```bash
   /Users/hsiaojohnny/dev/rename/scripts/gui.sh
   ```
5. 保存為「圖片命名」

---

## 📞 技術支援

### 查看詳細日誌

命名完成後，可以在以下位置查看詳細日誌：

```bash
cat logs/rename.log
```

### 查看分析結果

```bash
ls -la data/analysis_results/
```

---

## 📝 常見問題 (FAQ)

**Q: 命名後能恢復原檔名嗎？**  
A: 可以！在 `data/tracking/` 下有完整的映射記錄，記錄了所有原檔名和新檔名的對應關係。

**Q: 是否支援自定義命名規則？**  
A: 目前優先使用圖片中的標題（最準確），如果沒有標題則使用主題+子題分類。未來版本會支援自定義。

**Q: 能在多台電腦上使用嗎？**  
A: 可以！整個項目是自包含的，無硬編碼路徑，可以複製到任何位置或電腦上使用。

**Q: 支援哪些圖片格式？**  
A: 支援 PNG, JPG, JPEG, WebP, GIF, BMP（6 種標準格式）

---

**祝您使用愉快！有任何問題歡迎反饋。** 🎉



### 方式 2️⃣：互動式 Bash 腳本

**特點：**
- ✅ 友善的提示指引
- ✅ 自動處理路徑展開（~/ 等）
- ✅ 錯誤檢查和提示

**使用步驟：**

```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/interactive_rename.sh
```

### 方式 3️⃣：命令行直接調用（進階）

**如果您知道確切的資料夾路徑：**

```bash
python3 src/full_batch_rename_execute.py --target-dir ~/Downloads
```

---

## 🎯 常見情況指南

### 情況 1：第一次使用

1. 打開 LM Studio，啟動伺服器
2. 運行 GUI：
   ```bash
   bash scripts/gui.sh
   ```
3. 選擇要命名的資料夾
4. 點擊「開始命名」

### 情況 2：後續使用（新圖片）

程式會自動跳過已命名的檔案（檔名包含中文）

### 情況 3：重新命名舊圖片

勾選「強制重新命名」後運行

---

## ❌ 遇到問題怎麼辦？

### 問題 1：LM Studio 未啟動

**症狀：** 命名時出現「連接失敗」錯誤

**解決：** 
1. 打開 LM Studio 應用
2. 確保伺服器已啟動（顯示「Server is running」）
3. 重新運行命名

### 問題 2：找不到要命名的資料夾

**確認：**
- ✅ 資料夾路徑正確
- ✅ 資料夾中有圖片檔案
- ✅ 有讀取權限

### 問題 3：「找不到圖片檔案」

**可能原因：**
- 圖片在子資料夾中（但程式已支援遞迴掃描）
- 圖片格式不支援（只支援 PNG, JPG, JPEG, WebP, GIF, BMP）
- 圖片檔案已損壞

### 問題 4：命名速度很慢

**原因：**
- 首次分析需要啟動模型，可能需要 30-60 秒
- 大量圖片會分批處理
- GPU 加速可顯著提速

### 問題 5：某些圖片無法識別

**可能原因：**
- 圖片無法被模型處理（如損壞的圖片）
- 圖片中沒有可識別的文字內容
- WebP 等某些特殊格式（模型限制）

**解決方案：**
- 這是正常的，系統會跳過無法處理的圖片
- 檢查日誌文件瞭解詳細信息：
  ```bash
  cat logs/rename.log
  ```

---

## 📊 理解結果

### 生成的文件

命名完成後，會生成以下文件：

**在您的圖片資料夾中：**
- 新命名的圖片檔案
- 原檔案（如果您選擇保留）

**在項目資料夾中：**
- `data/analysis_results/` - 分析結果詳情
- `data/tracking/` - 追蹤記錄和映射表

### 驗收標準

✅ 命名準確度 > 95%  
✅ 0 個重複檔名  
✅ 看檔名就能聯想到圖片內容

---

## 🔧 進階設置

### 自定義配置

編輯 `config/config.yaml` 可以自定義：
- 輸出目錄
- 日誌設置
- API 超時時間

### 查看詳細日誌

```bash
tail -f logs/rename.log
```

---

## 📞 技術支援

詳見項目文件：
- README.md - 項目概述
- 修復記錄_遞迴掃描問題.md - 最新修復說明

---

**祝您使用愉快！** 🎉
