# 📖 使用指南 - 圖片智能命名系統 v1.1

## 👋 歡迎

這份指南幫助您輕鬆使用圖片智能命名系統。無論您是技術人員還是非技術人員，都可以快速上手。

**新增功能（v1.1）：**
- ✨ 智能檢測已命名 vs 未命名的檔案
- ✨ 增量模式（默認，跳過已命名）
- ✨ 強制重新命名模式（--force-rename）
- ✨ 全局檔案追蹤機制

---

## ⚡ 30 秒快速開始

### 第一次使用（5 分鐘）

1. **安裝必要工具**
   - 下載 Miniconda：https://docs.conda.io/projects/miniconda/en/latest/
   - 下載 LM Studio：https://lmstudio.ai/

2. **啟動 LM Studio**
   - 打開 LM Studio 應用
   - 搜索「qwen3-vl-30b」並下載
   - 點擊「Start Server」

3. **運行命名工具**
   ```bash
   cd /Users/hsiaojohnny/dev/rename
   bash scripts/interactive_rename.sh
   ```

4. **按照提示操作**
   - 選擇要命名的資料夾
   - 選擇是否刪除原檔案
   - 確認並等待完成

### 之後每次使用（只需 30 秒）
```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/interactive_rename.sh
```

---

## 📱 使用方式

### 方式 1：互動式命名（推薦所有人）

最簡單、最友善的方式，系統會一步步引導您。

**基本使用（增量模式 - 默認）：**
```bash
bash scripts/interactive_rename.sh
```
✅ 只命名未命名的檔案，跳過已命名的檔案

**強制重新命名模式：**
```bash
bash scripts/interactive_rename.sh --force-rename
```
✅ 重新命名所有檔案，包括已命名的檔案

**流程：**
1. 系統提示：`請輸入圖片資料夾的路徑`
   - 輸入您的圖片資料夾路徑，例如：`/Users/hsiaojohnny/Pictures`
   - 或按 Enter 使用預設的 `~/Downloads`

2. **智能檢測**（新功能 v1.1）
   - 系統會自動檢測已命名 vs 未命名的檔案
   - 顯示摘要：「檢測到 X 個已命名的檔案，Y 個未命名的檔案」
   - 提示您正在使用哪種模式（增量 或 強制）

3. 系統提示：`是否刪除原檔案？(Y/n)`
   - 按 `y` = 刪除原檔案（只保留新命名的）
   - 按 `n` = 保留原檔案（更安全，推薦）

4. 系統提示：`確認開始處理嗎？(y/n)`
   - 按 `y` 確認開始
   - 按 `n` 取消操作

5. ✅ 完成！系統會自動打開資料夾顯示結果

### 方式 2：快速版（最簡單，只需一個命令）

如果您的圖片都在 `~/Downloads` 並且想保留原檔案：

```bash
bash scripts/quick_rename.sh
```

### 方式 3：完整版（需要自訂，技術用戶）

支持詳細的配置和進階選項：

```bash
bash scripts/run_image_rename.sh
```

---

## 🎯 常見情況指南

### 情況 1：我的圖片在 `~/Downloads` 中

```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/interactive_rename.sh
```

1. 系統問：`請輸入圖片資料夾的路徑`
   - 直接按 **Enter**（使用預設 ~/Downloads）

2. 系統問：`是否刪除原檔案？`
   - 按 `n`（推薦，保留原檔案）

3. 按 `y` 確認開始

### 情況 2：我的圖片在其他資料夾（如 `~/Pictures`）

```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/interactive_rename.sh
```

1. 系統問：`請輸入圖片資料夾的路徑`
   - 輸入：`/Users/hsiaojohnny/Pictures`（或 `~/Pictures`）
   - 按 Enter 確認

2. 其他步驟相同（見上方）

### 情況 3：我想刪除原檔案，只保留新命名的

```bash
bash scripts/interactive_rename.sh
```

1-2. 正常選擇資料夾

3. 系統問：`是否刪除原檔案？`
   - 按 `y`

4. 系統問：`確定要刪除原檔案嗎？這個操作無法撤銷！`
   - 再按一次 `y` 確認（二次確認機制，防止誤刪）

5. 開始處理

⚠️ **注意：** 删除后無法恢復，請確保您有備份或確定要删除

### 情況 4：我想預覽結果，不打開資料夾

完成後，系統會問：`是否打開圖片目錄查看結果？`
- 按 `n` 跳過

### 情況 5：我現有命名不滿意，想強制重新命名所有檔案

```bash
bash scripts/interactive_rename.sh --force-rename
```

1. 系統會顯示：`強制重新命名模式已啟用（--force-rename）`
2. 選擇資料夾後，會提示：`強制模式：將重新命名全部 X 個檔案（包括已命名的）`
3. 按照正常流程確認
4. 所有檔案都會被重新分析和命名

💡 **提示：** 使用 `--override` 也有相同效果（別名）

### 情況 6：新圖片到達，但舊圖片還沒整理

```bash
bash scripts/interactive_rename.sh
```

✅ 默認增量模式：
- 已命名的檔案：自動跳過，節省時間和資源
- 未命名的檔案：正常分析和命名
- 系統會顯示：`檢測到 X 個已命名的檔案，Y 個未命名的檔案`

這是推薦的使用方式！

---

## ✅ 驗收標準 - 如何確認成功

命名完成後，您應該看到：

✅ **檔名包含中文描述**
```
例子：
  財經_投資分析_美股代號COIN.png
  AI技術_GPT-5.2-Codex_軟體工程典範移轉.png
  設計_UI元件庫_暗色主題表單.jpg
```

✅ **看檔名就能聯想到圖片內容**
- 檔名不再是 `copilot-image-xxx.png`
- 而是描述性的、有意義的名稱

✅ **沒有重複名稱**
- 每個檔案都有唯一的名稱

✅ **檔案格式正確**
- 原格式保留（.png、.jpg 等）

---

## ❌ 遇到問題？

### 問題 1：「找不到 Conda」

**原因：** Conda 沒有安裝或環境變數未設置

**解決方案：**
1. 確認已安裝 Miniconda：https://docs.conda.io/projects/miniconda/en/latest/
2. 關閉並重新打開終端
3. 驗證安裝：
   ```bash
   conda --version
   ```

### 問題 2：「LM Studio 未運行」

**原因：** LM Studio 沒有啟動或模型沒有加載

**解決方案：**
1. 打開 LM Studio 應用
2. 在搜索框搜索「qwen3-vl-30b」
3. 點擊 Download（首次約 30-60 分鐘）
4. 模型加載完後，點擊「Start Server」
5. 確保顯示「Server running on 127.0.0.1:1234」
6. 重新運行腳本

### 問題 3：「找不到圖片檔案」

**原因：** 指定的路徑不存在或沒有圖片

**解決方案：**
1. 確認資料夾路徑是否正確
2. 確保資料夾中有圖片（.jpg、.png、.gif 等）
3. 使用 `~/Pictures` 或 `~/Downloads` 等常見位置

### 問題 4：「某些圖片沒有被重命名」

**可能原因：**
- 圖片無法被模型處理（如損壞的圖片）
- 圖片中沒有可識別的文字內容
- WebP 等某些特殊格式（模型限制）

**解決方案：**
- 這是正常的，系統會跳過無法處理的圖片
- 檢查日誌文件瞭解詳細信息：
  ```bash
  cat /Users/hsiaojohnny/dev/rename/logs/run_*.log
  ```

### 問題 5：「不小心刪除了原檔案怎麼辦？」

**恢復步驟：**
1. 立即停止使用該磁碟（防止被覆蓋）
2. 使用文件恢復工具（如 Recuva、DiskDigger）
3. 如果有備份，從備份恢復

**預防措施：**
- 使用「保留原檔案」選項（推薦）
- 定期備份重要圖片

---

## 📊 理解結果

### 生成的文件

命名完成後，會生成以下文件：

**在您的圖片資料夾中：**
- 新命名的圖片檔案（例如：`財經_投資分析_美股代號COIN.png`）
- 原檔案（如果您選擇保留）

**在項目資料夾中：**
- `logs/run_YYYYMMDD_HHMMSS.log` - 詳細執行日誌
- `data/mapping_YYYYMMDD_HHMMSS.json` - 檔名映射表（舊名→新名）
- `data/analysis_YYYYMMDD_HHMMSS.json` - 分析結果詳情

### 理解映射表

`mapping_*.json` 文件記錄了所有重命名：

```json
{
  "copilot-image-abc123.png": {
    "new_name": "財經_投資分析_美股代號COIN.png",
    "status": "success",
    "title": "美股代號COIN",
    "theme": "財經"
  }
}
```

**用途：**
- 追蹤重命名歷史
- 恢復原始檔名
- 驗證重命名結果

---

## 🔄 重複運行

### 如何再次運行？

```bash
cd /Users/hsiaojohnny/dev/rename
bash scripts/interactive_rename.sh
```

每次運行時：
- 系統會檢測已命名的文件
- 只分析和命名新圖片
- 跳過已命名的文件

### 如何清除舊日誌？

```bash
# 刪除舊日誌（保留程式）
rm /Users/hsiaojohnny/dev/rename/logs/*.log
```

---

## 📚 進階使用

### 查看詳細日誌

```bash
# 查看最新日誌
cat /Users/hsiaojohnny/dev/rename/logs/run_*.log | tail -50

# 實時監視日誌
tail -f /Users/hsiaojohnny/dev/rename/logs/run_*.log
```

### 修改配置參數

編輯 `/Users/hsiaojohnny/dev/rename/config/config.yaml`：

```yaml
# 修改 LM Studio 地址
lm_studio:
  host: 127.0.0.1
  port: 1234

# 修改命名語言
naming:
  language: "zh-TW"  # 台灣繁體中文
  
# 修改批量大小（更快或更穩定）
analysis:
  batch_size: 10  # 每批 10 個圖片
  max_retries: 3  # 失敗重試 3 次
```

### 查看項目結構

```bash
cd /Users/hsiaojohnny/dev/rename
cat README.md          # 完整項目文檔
cat QUICK_START.md     # 快速開始
cat .github/copilot-instructions.md  # 開發指南
```

---

## 🎯 最佳實踐

### ✅ 推薦做法

1. **第一次使用時**
   - 保留原檔案（安全第一）
   - 測試一個資料夾
   - 檢查結果是否滿意

2. **日常使用時**
   - 定期備份重要圖片
   - 檢查一次命名結果
   - 確認無誤後再刪除原檔案

3. **遇到問題時**
   - 查看日誌文件
   - 閱讀常見問題章節
   - 確保 LM Studio 正常運行

### ❌ 避免做法

1. 不要在第一次使用時就刪除原檔案
2. 不要同時刪除多個資料夾的原檔案
3. 不要在 LM Studio 沒有啟動時運行

---

## 💡 提示和技巧

### 技巧 1：批量處理多個資料夾

```bash
# 依次處理多個資料夾
bash scripts/interactive_rename.sh  # 處理第一個資料夾
bash scripts/interactive_rename.sh  # 處理第二個資料夾
bash scripts/interactive_rename.sh  # 處理第三個資料夾
```

### 技巧 2：快速查看結果

```bash
# 列出新命名的檔案
ls /Users/hsiaojohnny/Pictures/*.png | head -20
```

### 技巧 3：驗證重命名成功率

```bash
# 查看映射表中成功的數量
grep -c '"status": "success"' /Users/hsiaojohnny/dev/rename/data/mapping_*.json
```

---

## 📞 獲得幫助

### 查看詳細文檔

```bash
# 完整項目手冊
cat /Users/hsiaojohnny/dev/rename/README.md

# 快速開始指南
cat /Users/hsiaojohnny/dev/rename/QUICK_START.md

# 開發和協作指南
cat /Users/hsiaojohnny/dev/rename/.github/copilot-instructions.md
```

### 查看錯誤信息

終端輸出通常會顯示清晰的錯誤信息，例如：
```
❌ LM Studio 未運行 (127.0.0.1:1234)
💡 請先打開 LM Studio 並加載 qwen3-vl-30b
```

按照提示操作即可。

---

## 🏆 成功案例

### 前：原始檔名
```
copilot-image-abc123.png
copilot-image-def456.png
copilot-image-ghi789.jpg
```

### 後：智能命名
```
財經_投資分析_美股代號COIN.png
AI技術_GPT-5.2-Codex_軟體工程典範移轉.png
UI設計_暗色主題_表單元件庫設計.jpg
```

看檔名就能直接聯想到圖片內容！✨

---

## 📋 檢查清單

使用前確認：
- [ ] 已安裝 Miniconda
- [ ] 已安裝 LM Studio
- [ ] LM Studio 已加載 qwen3-vl-30b 模型
- [ ] 圖片資料夾存在且有圖片
- [ ] 終端中可以運行 `conda --version`

使用後確認：
- [ ] 圖片已被正確重命名
- [ ] 檔名包含中文描述
- [ ] 沒有重複檔名
- [ ] 日誌文件已生成
- [ ] （如果選擇）原檔案已刪除

---

## 📌 下一步

1. **如果一切正常**
   - 開始使用系統處理您的圖片
   - 根據需要重複運行

2. **如果想瞭解更多**
   - 查看 README.md
   - 查看 .github/copilot-instructions.md

3. **如果想貢獻或改進**
   - 查看開發文檔
   - 參與項目改進

---

**最後更新：2026-01-24**  
**版本：1.0.0**  
**目標用戶：所有用戶（特別是非技術人員）**  
**難度等級：⭐ 極簡單**

---

## 📞 獲得幫助

有問題？查看：
1. 本指南的「遇到問題？」章節
2. 詳細日誌文件：`logs/run_*.log`
3. 項目文檔：`README.md`
4. 映射表：`data/mapping_*.json`

祝您使用愉快！ 🎉
